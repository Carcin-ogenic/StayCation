<% layout('/layouts/boilerplate.ejs') -%>
<body>
  <h3 class="my-3">Add New Listing</h3>
  <form
    id="listingForm"
    method="POST"
    action="/listings"
    class="needs-validation w-75"
    enctype="multipart/form-data"
    novalidate
  >
    <div class="mb-3">
      <label for="title" class="form-label">Title</label>
      <input name="listing[title]" id="title" placeholder="Enter Title" type="text" class="form-control" required />
      <div class="valid-feedback">Looks Good!</div>
      <div class="invalid-feedback">Enter a valid Title</div>
    </div>
    <div class="mb-3">
      <label for="Description" class="form-label">Description</label>
      <textarea
        name="listing[description]"
        id="Description"
        placeholder="Enter Description"
        class="form-control"
        rows="2"
        required
      ></textarea>
      <div class="invalid-feedback">Enter a valid Description</div>
    </div>
    <!-- <div class="mb-3">
      <label for="Image" class="form-label">Image URL</label>
      <input
        name="listing[image][url]"
        id="Image"
        placeholder="Enter Image URL/Link"
        type="text"
        class="form-control"
      />
    </div> -->
    <div class="mb-3">
      <label for="Image" class="form-label">Upload Listing Image</label>
      <input name="listing[image]" id="Image" type="file" class="form-control" />
    </div>
    <div class="mb-3">
      <label for="Price" class="form-label">Price</label>
      <input name="listing[price]" placeholder="Enter Price" type="number" class="form-control" id="Price" required />
      <div class="invalid-feedback">Enter a valid Price</div>
    </div>
    <div class="mb-3">
      <label for="Location" class="form-label">Location</label>
      <input
        name="listing[location]"
        placeholder="Enter Location"
        type="text"
        class="form-control"
        id="Location"
        required
      />
      <div class="invalid-feedback">Enter a valid Location</div>
    </div>
    <div class="mb-3">
      <label for="Country" class="form-label">Country</label>
      <input
        name="listing[country]"
        placeholder="Enter Country"
        type="text"
        class="form-control"
        id="Country"
        required
      />
      <div class="invalid-feedback">Enter a valid Country</div>
    </div>
    <button type="submit" class="w-25 mb-3 btn btn-dark add-btn">
      Add &nbsp;
      <span class="spinner-border spinner-border-sm d-none" id="btnSpinner" role="status" aria-hidden="true"></span>
    </button>
  </form>
  <script>
    document.getElementById("listingForm").addEventListener("submit", function () {
      const btn = this.querySelector('button[type="submit"]');
      btn.disabled = true;
      btn.querySelector("#btnSpinner").classList.remove("d-none");
    });
  </script>
</body>
